# å¯è°ƒç”¨å¯¹è±¡

> C++ æä¾›äº†å¤šç§æ–¹å¼æ¥è¡¨ç¤ºå’Œæ“ä½œå¯è°ƒç”¨å¯¹è±¡ï¼ŒåŒ…æ‹¬**å…¨å±€å‡½æ•°**ã€**å‡½æ•°æŒ‡é’ˆ**ã€**ä»¿å‡½æ•°ï¼ˆFunctorsï¼‰**ã€**Lambdaè¡¨è¾¾å¼**ã€**`std::function`** å’Œ **`std::bind`** ç­‰ã€‚
>
> è¿™äº›å·¥å…·æå¤§åœ°å¢å¼ºäº†C++çš„çµæ´»æ€§å’Œè¡¨è¾¾èƒ½åŠ›ï¼Œå°¤å…¶åœ¨**å¤„ç†å›è°ƒã€äº‹ä»¶é©±åŠ¨ç¼–ç¨‹ã€æ³›å‹ç®—æ³•ã€å¹¶å‘ç¼–ç¨‹ç­‰**è¡¨ç°å°¤ä¸ºå‡ºè‰²ã€‚



ğŸ‘‰ **å¯ä»¥ç†è§£ä¸ºï¼š**

- **å‡½æ•°æŒ‡é’ˆ**ï¼šä¼ ç»Ÿæ‰‹æ®µ
- **ä»¿å‡½æ•° & Lambda**ï¼šç°ä»£å¯è°ƒç”¨å¯¹è±¡
- **`std::function`**ï¼šç»Ÿä¸€æ¥å£ï¼Œè£…ä¸‹æ‰€æœ‰å¯è°ƒç”¨å¯¹è±¡
- **`std::bind`**ï¼šå‚æ•°ç»‘å®š/æˆå‘˜å‡½æ•°é€‚é…



## å‡½æ•°æŒ‡é’ˆ

> C++æœ€åŸºæœ¬çš„å¯è°ƒç”¨å¯¹è±¡ã€‚**æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆå˜é‡**ï¼Œä¿ç•™äº†æŸä¸ªå‡½æ•°çš„**å…¥å£åœ°å€**ã€‚



### åŸºæœ¬è¯­æ³•

```cpp
#include <iostream>

// å®šä¹‰å‡½æ•°æŒ‡é’ˆç±»å‹çš„å˜é‡
int (*funcPtr)(int, int);
// using funcPtr = int(*) (int, int); //ä¸€æ ·çš„æ„æ€

// å®šä¹‰ä¸€ä¸ªæ™®é€šå‡½æ•°
int add(int a, int b)
{
  return a + b;
}

int main()
{
  // ä½¿å‡½æ•°æŒ‡é’ˆæŒ‡å‘å‡½æ•°
  // funcPtr = add;  //ä¸¤ç§å†™æ³•éƒ½å¯ä»¥ï¼Œå‡½æ•°åä¼šè‡ªåŠ¨è½¬æ¢æˆå‡½æ•°æŒ‡é’ˆï¼Œç±»æ¯”äºæ•°ç»„åå³æ•°ç»„é¦–åœ°å€
  funcPtr = &add;

  // (*funcPtr)(2, 3) //å¯ä»¥ä¸è§£å¼•ç”¨ï¼Œç¼–è¯‘å™¨ä¼šè‡ªè¡Œè°ƒç”¨å‡½æ•°
  std::cout << funcPtr(1, 2); 
  return 0;
}
```

> `funcPtr` å³å‡½æ•°æŒ‡é’ˆã€‚



### å¸¸ç”¨å¤„

#### å›è°ƒæœºåˆ¶

```cpp
#include <iostream>

// å®šä¹‰å‡½æ•°æŒ‡é’ˆç±»å‹
using FuncPtr = int(*)(int, int);

void compute(int a, int b, FuncPtr f) 
{
    std::cout << "Result: " << f(a, b) << std::endl;
}

int add(int a, int b) { return a + b; }
int sub(int a, int b) { return a - b; }

int main()
{
    compute(5, 3, add); // ä¼ å…¥ä¸åŒçš„å‡½æ•°
    compute(5, 3, sub);
}
```



#### å‡½æ•°æŒ‡é’ˆæ•°ç»„

> å¯ä»¥ä¿å­˜å¤šä¸ªå‡½æ•°æŒ‡é’ˆï¼Œç”¨æ¥å®ç° **â€œå‡½æ•°è¡¨â€**ï¼š

```cpp
int add(int a, int b) { return a + b; }
int sub(int a, int b) { return a - b; }

int (*ops[2])(int, int) = { add, sub };

int main() 
{
    std::cout << ops[0](3, 2) << std::endl; // add
    std::cout << ops[1](3, 2) << std::endl; // sub
}
```



#### æˆå‘˜å‡½æ•°æŒ‡é’ˆ

> æ™®é€šå‡½æ•°æŒ‡é’ˆåªèƒ½æŒ‡å‘**å…¨å±€å‡½æ•°**æˆ–**é™æ€æˆå‘˜å‡½æ•°**ï¼›
> è‹¥è¦æŒ‡å‘ç±»çš„éé™æ€æˆå‘˜å‡½æ•°ï¼Œéœ€è¦ **æˆå‘˜å‡½æ•°æŒ‡é’ˆ**ï¼š

```cpp
class Foo 
{
    int bar(int x) { return x + 1; }
};

int main() 
{
    Foo foo;
    int (Foo::*mp)(int) = &Foo::bar; // æˆå‘˜å‡½æ•°æŒ‡é’ˆ
    std::cout << (foo.*mp)(10) << std::endl; // è°ƒç”¨
}
```

> åŠ ä½œç”¨åŸŸå³å¯ã€‚



### æ€»ç»“

â€‹	**ä¼˜ç‚¹ï¼š**

1. ç®€å•ç›´è§‚ï¼Œé€‚ç”¨äºç®€å•çš„å›è°ƒå‡½æ•°

â€‹	**ç¼ºç‚¹ï¼š**

2. **ä¸èƒ½æ•è·ä¸Šä¸‹æ–‡**ï¼Œä¸ `lambda` è¡¨è¾¾å¼æœ¬è´¨çš„åŒºåˆ«ã€‚
3. è¯­æ³•ç›¸å¯¹éš¾å†™éš¾çœ‹





## ä»¿å‡½æ•°(Functors)

> **ä»¿å‡½æ•°ï¼ˆFunctorsï¼‰**ï¼Œåˆç§°**å‡½æ•°å¯¹è±¡ï¼ˆFunction Objectsï¼‰**ï¼Œæ˜¯åœ¨C++ä¸­é‡è½½äº† `operator()` çš„ç±»æˆ–ç»“æ„ä½“å®ä¾‹ã€‚
>
> ä»¿å‡½æ•°ä¸ä»…å¯ä»¥åƒæ™®é€šå‡½æ•°ä¸€æ ·è¢«è°ƒç”¨ï¼Œ**è¿˜èƒ½æºå¸¦çŠ¶æ€**ï¼Œæä¾›æ›´å¤§çš„çµæ´»æ€§å’ŒåŠŸèƒ½æ€§ã€‚

| ç‰¹æ€§     | æ™®é€šå‡½æ•°           | å‡½æ•°å¯¹è±¡                             |
| -------- | ------------------ | ------------------------------------ |
| æœ¬è´¨     | ä¸€æ®µå¯æ‰§è¡Œä»£ç      | ç±»çš„å®ä¾‹ï¼ˆå¯¹è±¡ï¼‰                     |
| å®šä¹‰     | åªèƒ½åœ¨å®šä¹‰æ—¶å®ä¾‹åŒ– | ç±»ä¸­**é‡è½½ `operator()` è¿ç®—ç¬¦**å®ç° |
| è°ƒç”¨æ–¹å¼ | `f(x)`             | `obj(x)`                             |
| çŠ¶æ€     | æ— æ³•ä¿å­˜           | **å¯ä¿å­˜æˆå‘˜å˜é‡çš„çŠ¶æ€**             |
| åº”ç”¨åœºæ™¯ | å•æ¬¡åŠŸèƒ½è°ƒç”¨       | STL ç®—æ³•ã€è‡ªå®šä¹‰è¡Œä¸ºã€å¯æºå¸¦æ•°æ®     |



### åŸºæœ¬è¯­æ³•

```cpp
#include <iostream>
struct Adder
{
  int to_add;
  Adder(int value) : to_add(value) {}

  int operator()(int x)
  {
    return x + to_add;
  }
};

int main()
{
  Adder add(5);	//å…ˆè°ƒç”¨æ„é€ å‡½æ•°ï¼Œæºå¸¦çŠ¶æ€
  std::cout << add(10) << std::endl;	//ä¿å­˜çŠ¶æ€ï¼Œè¿è¡Œ10+5
}
```



â€‹	**ç¤ºä¾‹ï¼š**

```cpp
//1ã€å‡½æ•°å¯¹è±¡åœ¨ä½¿ç”¨æ—¶ï¼Œå¯ä»¥åƒæ™®é€šå‡½æ•°é‚£æ ·è°ƒç”¨, å¯ä»¥æœ‰å‚æ•°ï¼Œå¯ä»¥æœ‰è¿”å›å€¼
class MyAdd
{
public :
	int operator()(int v1,int v2)
	{
		return v1 + v2;
	}
};

void test01()
{
	MyAdd myAdd;
	cout << myAdd(10, 10) << endl;
}

//2ã€å‡½æ•°å¯¹è±¡å¯ä»¥æœ‰è‡ªå·±çš„çŠ¶æ€
class MyPrint
{
public:
	MyPrint()
	{
		count = 0;
	}
	void operator()(string test)
	{
		cout << test << endl;
		count++; //ç»Ÿè®¡ä½¿ç”¨æ¬¡æ•°
	}

	int count; //å†…éƒ¨è‡ªå·±çš„çŠ¶æ€
};
void test02()
{
	MyPrint myPrint;
	myPrint("hello world");
	myPrint("hello world");
	myPrint("hello world");
	cout << "myPrintè°ƒç”¨æ¬¡æ•°ä¸ºï¼š " << myPrint.count << endl;
}

//3ã€å‡½æ•°å¯¹è±¡å¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’
void doPrint(MyPrint &mp , string test)
{
	mp(test);
}

void test03()
{
	MyPrint myPrint;
	doPrint(myPrint, "Hello C++");
}

int main()
{
	//test01();
	//test02();
	test03();
	return 0;
}
```



### å¸¸ç”¨å¤„

#### ä»¿å‡½æ•°ä¸STLé€šç”¨ç®—æ³•

> ä»¿å‡½æ•°å¸¸ç”¨äº [STLé€šç”¨ç®—æ³•å‡½æ•°](./STLåŸºç¡€è¯­æ³•#STLé€šç”¨ç®—æ³•) çš„å¯æ‰©å±•æ¥å£å¤„ã€‚

â€‹	**ç¤ºä¾‹ï¼š**

```cpp
#include <iostream>
#include <vector>
#include <algorithm>

// ä»¿å‡½æ•°ï¼šåˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦å¤§äºæŸä¸ªé˜ˆå€¼
struct IsGreaterThan 
{
    int threshold;
    IsGreaterThan(int t) : threshold(t) {}
    bool operator()(int x) const 
    {
        return x > threshold;
    }
};

int main() 
{
    std::vector<int> numbers = {1, 5, 10, 15, 20};

    // ä½¿ç”¨ä»¿å‡½æ•°è¿›è¡Œç­›é€‰
    IsGreaterThan greaterThan10(10);
    auto it = std::find_if(numbers.begin(), numbers.end(), greaterThan10);

    if(it != numbers.end()) 
    {
        std::cout << "ç¬¬ä¸€ä¸ªå¤§äº10çš„æ•°æ˜¯: " << *it << std::endl; // è¾“å‡º: ç¬¬ä¸€ä¸ªå¤§äº10çš„æ•°æ˜¯: 15
    } 
    else 
    {
        std::cout << "æ²¡æœ‰æ‰¾åˆ°å¤§äº10çš„æ•°ã€‚" << std::endl;
    }
    return 0;
}
```



#### ä»¿å‡½æ•°ä¸æ¨¡æ¿

> ä»¿å‡½æ•°ä¸æ¨¡æ¿ç›¸ç»“åˆï¼Œå¯ä»¥å®ç°é«˜åº¦é€šç”¨å’Œå¯å¤ç”¨çš„ä»£ç ã€‚ä¾‹å¦‚ï¼Œç¼–å†™ä¸€ä¸ªé€šç”¨çš„æ¯”è¾ƒä»¿å‡½æ•°ã€‚

â€‹	**ç¤ºä¾‹ï¼š**

```cpp
#include <iostream>
#include <vector>
#include <algorithm>

// é€šç”¨æ¯”è¾ƒä»¿å‡½æ•°
template <typename T>
struct Compare
{
    bool operator()(const T& a, const T& b) const 
    {
        return a < b;
    }
};

int main() 
{
    std::vector<int> numbers = {5, 2, 8, 1, 9};

    // ä½¿ç”¨ä»¿å‡½æ•°è¿›è¡Œæ’åº
    std::sort(numbers.begin(), numbers.end(), Compare<int>());

    std::cout << "æ’åºåçš„æ•°å­—: ";
    for(auto num : numbers)
    {
        std::cout << num << " "; // è¾“å‡º: 1 2 5 8 9
    }
    std::cout << std::endl;

    return 0;
}
```



### æ€»ç»“

| **ä¼˜åŠ¿**               | **æè¿°**                                                     |
| ---------------------- | ------------------------------------------------------------ |
| **å¯æ‰©å±•æ€§**           | å¯ä»¥æ ¹æ®éœ€æ±‚çµæ´»åœ°æ·»åŠ æ›´å¤šåŠŸèƒ½å’ŒçŠ¶æ€ï¼Œé€‚åº”å¤æ‚çš„åº”ç”¨åœºæ™¯ã€‚   |
| **ä¸ Lambda çš„äº’è¡¥æ€§** | å½“éœ€è¦æºå¸¦å¤æ‚çŠ¶æ€æˆ–å¤šæ¬¡è°ƒç”¨æ—¶ï¼Œä»¿å‡½æ•°æ¯” Lambda æ›´åŠ åˆé€‚ï¼Œå…·æœ‰æ›´å¼ºçš„çµæ´»æ€§ã€‚ |
| **ç±»å‹å®‰å…¨**           | ä»¿å‡½æ•°æ˜¯å…·ä½“çš„ç±»å‹ï¼Œç¼–è¯‘å™¨å¯ä»¥è¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œç¡®ä¿ç±»å‹å®‰å…¨ã€‚   |



| **ä½¿ç”¨åœºæ™¯**       | **æè¿°**                                                     |
| ------------------ | ------------------------------------------------------------ |
| **éœ€è¦æºå¸¦çŠ¶æ€æ—¶** | å½“å›è°ƒå‡½æ•°éœ€è¦ç»´æŠ¤å†…éƒ¨çŠ¶æ€æ—¶ï¼Œä»¿å‡½æ•°éå¸¸é€‚ç”¨ï¼Œèƒ½å¤ŸæŒä¹…åŒ–çŠ¶æ€ä¿¡æ¯ã€‚ |
| **å¤æ‚æ“ä½œ**       | åœ¨ç®€å•çš„å‡½æ•°æŒ‡é’ˆæˆ– Lambda æ— æ³•è¡¨è¾¾å¤æ‚é€»è¾‘æ—¶ï¼Œä»¿å‡½æ•°æä¾›æ›´é«˜çš„è¡¨è¾¾èƒ½åŠ›ã€‚ |
| **æ€§èƒ½å…³é”®åœºæ™¯**   | ä»¿å‡½æ•°èƒ½è¢«ç¼–è¯‘å™¨ä¼˜åŒ–ï¼Œé€‚ç”¨äºéœ€è¦é«˜æ€§èƒ½çš„ä»£ç ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤§é‡è°ƒç”¨æ—¶ã€‚ |





## lambdaè¡¨è¾¾å¼

> C++11 ã€‚`lambda` è¡¨è¾¾å¼**æœ¬è´¨ä¸Š**æ˜¯ä¸€ä¸ª**åŒ¿åç±»çš„å¯¹è±¡ (ä»¿å‡½æ•°)**ã€‚



### åŸºæœ¬è¯­æ³•

```cpp
[capture](parameter_list) -> return_type 
{
    function_body;
};
```

- **`[capture]` æ•è·åˆ—è¡¨**ï¼šæŒ‡å®šå¦‚ä½•æ•è·ä½¿ç”¨å¤–éƒ¨ä½œç”¨åŸŸçš„å˜é‡ã€‚

- **`parameter_list` å‚æ•°åˆ—è¡¨**ï¼šå’Œæ™®é€šå‡½æ•°ä¸€æ ·ã€‚

- **`return_type` è¿”å›ç±»å‹**ï¼šå¯ä»¥çœç•¥ï¼ˆC++14+ ç¼–è¯‘å™¨èƒ½è‡ªåŠ¨æ¨å¯¼ï¼‰ã€‚

- **`function_body` å‡½æ•°ä½“**ï¼šå®é™…æ‰§è¡Œçš„é€»è¾‘ã€‚



â€‹	**æ•è·åˆ—è¡¨ï¼ˆé‡ç‚¹ï¼‰ï¼š**

| æ•è·æ–¹å¼    | ç¤ºä¾‹                              | å«ä¹‰                                                         |
| ----------- | --------------------------------- | ------------------------------------------------------------ |
| `[ ]`       | `[ ](){ }`                        | ä¸æ•è·ä»»ä½•å¤–éƒ¨å˜é‡                                           |
| `[=]`       | `[=](){ return a + b; }`          | æŒ‰å€¼æ•è·ï¼ˆæ‹·è´å¤–éƒ¨å˜é‡ï¼‰<br />åŠ  `mutable` å…³é”®å­—å¯ä»¥ä¿®æ”¹æ‹·è´å‰¯æœ¬ |
| `[&]`       | `[&](){ b += 1; }`                | æŒ‰å¼•ç”¨æ•è·ï¼ˆå…è®¸ä¿®æ”¹å¤–éƒ¨å˜é‡ï¼‰                               |
| `[a]`       | `[a](){ return a*2; }`            | åªæ•è·å˜é‡ `a`ï¼ˆæŒ‰å€¼ï¼‰                                       |
| `[&a]`      | `[&a](){ a++; }`                  | åªæ•è·å˜é‡ `a`ï¼ˆæŒ‰å¼•ç”¨ï¼‰                                     |
| `[=,&b]`    | `[=,&b](){ b++; return a+b; }`    | `a` æŒ‰å€¼ï¼Œ`b` æŒ‰å¼•ç”¨                                         |
| `[this]`    | `[this]{ return this->member; }`  | æ•è·å½“å‰å¯¹è±¡ï¼ˆåœ¨ç±»é‡Œå¸¸ç”¨ï¼‰                                   |
| `[=, this]` | `[=]{ return this->member + a; }` | æ•è·æ‰€æœ‰å¤–éƒ¨å˜é‡æŒ‰å€¼ + å½“å‰å¯¹è±¡                              |

 

â€‹	**ç¤ºä¾‹ï¼š**

```cpp
#include <iostream>
int main()
{
  int x = 10, y = 20;

  auto f1 = [=]() { return x + y; };	//è¿”å›30ï¼Œæ­¤å¤„æ˜¯æŒ‰å€¼æ•è·ï¼Œå³æ‹·è´ä¸€ä»½ï¼Œé»˜è®¤æ˜¯åªè¯»constï¼Œä¸èƒ½ä¿®æ”¹ï¼Œå› æ­¤ä¸èƒ½++x

  auto f2 = [&]() { return ++x + ++y; };	//è¿”å›32ï¼Œæ­¤å¤„æ˜¯å¼•ç”¨æ•è·ï¼Œè®¿é—®çš„æ˜¯çœŸå®çš„xå’Œy
     
  cout << f1() << endl; // 30
  cout << f2() << endl; // 32 ï¼ˆä¿®æ”¹äº† x,yï¼‰
}
```

> å› ä¸º `lambda` æœ¬è´¨æ˜¯åŒ¿åç±»å¯¹è±¡ï¼Œæ‰€ä»¥è°ƒç”¨çš„æ—¶å€™ä¹Ÿæ˜¯ä»¥ `f()` è¿™ç§åŠ æ‹¬å·çš„å½¢å¼ã€‚



### å¸¸ç”¨å¤„

#### ä¿®æ”¹æ‹·è´æ•è·ä¿®æ”¹æƒé™

> `lambda` è¡¨è¾¾å¼**æ‹·è´æŒ‰å€¼æ•è·é»˜è®¤æ˜¯ `const` åªè¯»**ï¼Œ**ä¸å¯ä¿®æ”¹**ã€‚ä½†æ˜¯å¯ä»¥åŠ ä¸Š **`mutable` å…³é”®å­—**å…è®¸ä¿®æ”¹æ•è·çš„å˜é‡å‰¯æœ¬**(ä»…å‰¯æœ¬)**ã€‚

â€‹	

â€‹	**ä¸Šè¿°ä¾‹å­ä¿®æ”¹ï¼š**

```cpp
#include <iostream>
using namespace std;

int main()
{
  int x = 10, y = 20;

  auto f1 = [=]() mutable
  { return ++x + ++y; }; // æ­¤å¤„å¯ä»¥ä¿®æ”¹xå’Œyçš„å‰¯æœ¬

  cout << f1() << endl; // 32

  cout << x << y;	// è¿˜æ˜¯10å’Œ20
}
```

> ä½¿ç”¨ **`mutable` å…³é”®å­—**å¯ä»¥ä¿®æ”¹æŒ‰å€¼æ•è·çš„æ‹·è´å˜é‡ï¼Œä½†æ˜¯**åªä¿®æ”¹äº†å‰¯æœ¬**ï¼Œä¸å½±å“å¤–éƒ¨ `x` å’Œ `y` çš„å€¼ã€‚



#### æ•è·this

> Lambdaè¡¨è¾¾å¼å¯ä»¥æ•è·ç±»çš„æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°ï¼Œä½¿å…¶åœ¨ç±»çš„ä¸Šä¸‹æ–‡ä¸­æ›´åŠ çµæ´»ã€‚**å³æ•è· `this`ã€‚**

â€‹	**ç¤ºä¾‹ï¼š**

```cpp
#include <iostream>
#include <vector>
#include <algorithm>

// å¤„ç†å™¨ç±»
class Processor
{
public:
  Processor(int threshold) : _threshold(threshold) {}

  // å¤„ç†æ•°æ®çš„å‡½æ•°
  void process(std::vector<int> &data)
  {
    std::cout << "before process data: ";
    for (auto num : data)
    {
      std::cout << num << " ";
    }
    std::cout << std::endl;

    // å¾ªç¯å°†æ»¡è¶³å°äº _threshold çš„å€¼ç§»åŠ¨åˆ°æ•°ç»„æœ«å°¾ï¼Œä¼šè¿”å›æŒ‡å‘æ–°é€»è¾‘ç»“å°¾çš„è¿­ä»£å™¨
    auto new_end = std::remove_if(data.begin(), data.end(), [this](int n)	//æ•è·å½“å‰å¯¹è±¡ï¼Œå³å¯è®¿é—®ç§æœ‰æˆå‘˜
                                  { return n < _threshold; });

    // åˆ é™¤é€»è¾‘ç»“å°¾åˆ°çœŸå®ç»“å°¾çš„æ•°æ®å³åˆ é™¤æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„æ•°æ®
    data.erase(new_end, data.end());

    // æ‰“å°å¤„ç†åçš„æ•°æ®
    std::cout << "have processed data: ";
    for (auto num : data)
    {
      std::cout << num << " ";
    }
    std::cout << std::endl;
  }

private:
  int _threshold;
};

int main()
{
  // è®¾ç½®é˜ˆå€¼ä¸º5
  Processor processor(5);

  std::vector<int> vec{0, 2, 4, 6, 8, 10};
  processor.process(vec);
  return 0;
}
```



#### lambdaä¸STLé€šç”¨ç®—æ³•

> å’Œä»¿å‡½æ•°ä¸€æ ·å¸¸ç”¨äº [STLé€šç”¨ç®—æ³•å‡½æ•°](./STLåŸºç¡€è¯­æ³•#STLé€šç”¨ç®—æ³•) çš„å¯æ‰©å±•æ¥å£å¤„ã€‚

â€‹	**ç¤ºä¾‹ï¼š**

```cpp
#include <iostream>
#include <vector>
#include <algorithm>

int main() {
    std::vector<int> numbers = {4, 2, 5, 1, 3};

    // ä½¿ç”¨Lambdaè¡¨è¾¾å¼è¿›è¡Œæ’åº
    std::sort(numbers.begin(), numbers.end(),
        [](int a, int b) -> bool {
            return a < b;
        });

    std::cout << "æ’åºåçš„æ•°å­—: ";
    for(auto num : numbers) {
        std::cout << num << " "; // è¾“å‡º: 1 2 3 4 5
    }
    std::cout << std::endl;

    return 0;
}
```



### æ€»ç»“

| **ä¼˜åŠ¿**              | **æè¿°**                                                     |
| --------------------- | ------------------------------------------------------------ |
| **ç®€æ´**              | åŒ¿åç±»å¯¹è±¡ï¼Œç›¸æ¯”äºä»¿å‡½æ•°ï¼Œä¸éœ€è¦å¤–éƒ¨å®šä¹‰ï¼Œä»£ç æ›´ç´§å‡‘ï¼Œæ˜“äºç†è§£ã€‚ |
| **çµæ´»**              | æ”¯æŒæŒ‰éœ€æ•è·å¤–éƒ¨å¯¹è±¡ï¼Œèƒ½å¤Ÿå®ç°ç±»ä¼¼é—­åŒ…çš„åŠŸèƒ½ï¼Œä½¿å¾—ä»£ç æ›´åŠ çµæ´»ã€‚ |
| **æ€§èƒ½ä¼˜åŒ–**          | ç¼–è¯‘å™¨ä¼šå¯¹ lambda è¡¨è¾¾å¼è¿›è¡Œä¼˜åŒ–ï¼Œç±»ä¼¼å†…è”å±•å¼€ï¼Œå‡å°‘ä¸å¿…è¦çš„å‡½æ•°è°ƒç”¨ã€‚ |
| **ç»“åˆ STL é€šç”¨ç®—æ³•** | èƒ½å¤Ÿä¸ STL é€šç”¨ç®—æ³•ï¼ˆå¦‚ `std::sort`ï¼‰æ— ç¼ç»“åˆï¼Œæé«˜ä»£ç é€»è¾‘çš„ç®€æ´æ€§ä¸æ•ˆç‡ã€‚ |

| ç¼ºç‚¹     | æè¿°                                                         |
| -------- | ------------------------------------------------------------ |
| é€»è¾‘éš¾æ‡‚ | å› ä¸ºæ˜¯åŒ¿åç±»å¯¹è±¡ï¼Œç›¸å½“äºå£°æ˜å’Œå®ç°å†™åœ¨ä¸€èµ·äº†ï¼Œæ²¡æœ‰ç‹¬ç«‹çš„å‡½æ•°ä½“ï¼Œç‰¹åˆ«æ˜¯åœ¨å‡½æ•°å›è°ƒä½¿ç”¨æ—¶æœ‰ç‚¹éš¾çœ‹æ‡‚ã€‚ |



## std::function

> `std::function` æ˜¯**C++11**æä¾›çš„ä¸€ä¸ª**æ¨¡æ¿ç±»**ï¼Œèƒ½å¤Ÿ**å°è£…ä»»ä½•å¯è°ƒç”¨å¯¹è±¡**ã€‚å¤´æ–‡ä»¶ `<functional>`
>
> å®ƒå®ç°äº†**ç±»å‹æ“¦é™¤**ï¼Œä½¿å¾—ä¸åŒç±»å‹çš„å¯è°ƒç”¨å¯¹è±¡**å¯ä»¥é€šè¿‡ç»Ÿä¸€çš„æ¥å£è¿›è¡Œæ“ä½œ**ã€‚



### åŸºæœ¬è¯­æ³•

> ç”±äº`std::function` æ˜¯ä¸€ä¸ªæ¨¡æ¿ç±»ï¼Œå› æ­¤å…¶æ¨¡æ¿å‚æ•°æŒ‡å®šäº†å‡½æ•°çš„ç­¾åï¼š
>
> ä¾‹å¦‚ **`function<int (int ,int)>`** ç¬¬ä¸€ä¸ªintæ˜¯è¿”å›ç±»å‹ï¼Œåä¸¤ä¸ªintæ˜¯å‚æ•°ç±»å‹ã€‚ä¸€èµ·æŒ‡å®šäº†å®ä¾‹åŒ–å¯¹è±¡çš„æ•°æ®ç±»å‹ã€‚



â€‹	**ç¤ºä¾‹ï¼š**

```cpp
#include <iostream>
#include <functional>

// æ™®é€šå‡½æ•°
int add(int a, int b)
{
  return a + b;
}

// å‡½æ•°å¯¹è±¡,ä¹˜æ³•ç±»
struct Multiply
{
  int operator()(int a, int b) const
  {
    return a * b;
  }
};

int main()
{
  // å°è£…æ™®é€šå‡½æ•° std::functionæ˜¯æ¨¡æ¿ç±»ï¼Œ<>å†…æ•°æ®ç±»å‹è¡¨ç¤ºäº†å…¶å®ä¾‹åŒ–å¯¹è±¡çš„æ•°æ®ç±»å‹ï¼Œç¬¬ä¸€ä¸ªintæ˜¯è¿”å›ç±»å‹ï¼Œåä¸¤ä¸ªintæ˜¯å‚æ•°ç±»å‹
  std::function<int(int, int)> func1 = add; // æ‹·è´æ„é€ 
  std::cout << "+ :" << func1(3, 4) << std::endl;

  //å°è£…ä»¿å‡½æ•°
  Multiply multiply;
  std::function<int(int, int)> func2 = multiply;
  std::cout << "* :" << func2(3, 4) << std::endl;

  // lambdaè¡¨è¾¾å¼
  std::function<int(int, int)> func3 = [](int a, int b)
  { return a - b; };
  std::cout << "- :" << func3(3, 4) << std::endl;
}
```



### å¸¸ç”¨å¤„

#### å›è°ƒæœºåˆ¶

```cpp
#include <iostream>
#include <functional>

// å®šä¹‰å›è°ƒç±»å‹
using Callback = std::function<void(int)>; // æ­¤æ—¶Callback=functionç±»

// è§¦å‘äº‹ä»¶çš„å‡½æ•°
void triggerEvent(Callback cb, int value) // å›è°ƒå¯¹è±¡å’Œå…¶å€¼
{
  // äº‹ä»¶å‘ç”Ÿå°±è°ƒç”¨å›è°ƒå‡½æ•°
  value *= 2;
  cb(value);
}

int main()
{
  // å®šä¹‰å›è°ƒå‡½æ•°,ä½¿ç”¨lambdaè¡¨è¾¾å¼
  triggerEvent([](int x)
               { std::cout << "äº‹ä»¶è§¦å‘ï¼Œå€¼ä¸º:" << x << std::endl; }, 42);

  // å®šä¹‰å›è°ƒå‡½æ•°,ä½¿ç”¨ä»¿å‡½æ•°
  struct Printer
  {
    void operator()(int x) const
    {
      std::cout << "Printeræ‰“å°å€¼:" << x << std::endl;
    }
  } printer;

  triggerEvent(printer, 100);

  return 0;
}
```



#### é›†ä½“å­˜å‚¨ä¸è°ƒç”¨

```cpp
#include <iostream>
#include <functional>
#include <vector>

int add(int a, int b)
{
  return a + b;
}

struct Multiply
{
  int operator()(int a, int b) const
  {
    return a * b;
  }
};

int main()
{
  std::vector<std::function<int(int, int)>> vec_func; // åˆ›å»ºäº†å…ƒç´ ç±»å‹ä¸ºfunctionçš„æ•°ç»„

  vec_func.emplace_back(add);
  vec_func.emplace_back(Multiply()); // åˆ›å»ºäº†ä¸€ä¸ªç±»çš„ä¸´æ—¶å¯¹è±¡ï¼Œå°±ä¸ç”¨å†å®ä¾‹åŒ–å†æ‹·è´ä¸€ä»½å¢åŠ å¼€é”€
  vec_func.emplace_back([](int a, int b)
                        { return a - b; });

  for (auto &tmp : vec_func)	//å¼•ç”¨å‡å°‘å¼€é”€
  {
    std::cout << tmp(10, 5) << std::endl;
  }

  return 0;
}
```



### æ€»ç»“

| **ä¼˜åŠ¿**     | **æè¿°**                                                     |
| ------------ | ------------------------------------------------------------ |
| **ç±»å‹æ“¦é™¤** | å¯ä»¥**å­˜å‚¨ä»»ä½•ç¬¦åˆç­¾åçš„å¯è°ƒç”¨å¯¹è±¡**ï¼Œæ”¯æŒä¸åŒç±»å‹çš„å‡½æ•°ã€Lambda å’Œä»¿å‡½æ•°ç­‰ã€‚ |
| **çµæ´»**     | æ”¯æŒåŠ¨æ€æ”¹å˜å­˜å‚¨çš„å¯è°ƒç”¨å¯¹è±¡ï¼Œä½¿å¾—ä»£ç æ›´å…·çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ã€‚ |

| **ç¼ºç‚¹** | **æè¿°**                                                     |
| -------- | ------------------------------------------------------------ |
| **å¼€é”€** | ç›¸æ¯”äºç›´æ¥ä½¿ç”¨å‡½æ•°æŒ‡é’ˆæˆ– Lambdaï¼Œå…¶å¼€é”€ç•¥é«˜ï¼Œå› ä¸º `std::function` éœ€è¦è¿›è¡Œç±»å‹æ“¦é™¤å’ŒåŠ¨æ€å†…å­˜åˆ†é…ã€‚ |



## std::bind

> `std::bind` æ˜¯**C++11**æä¾›çš„ä¸€ä¸ª**å‡½æ•°æ¨¡æ¿ã€‚** å°†å¯è°ƒç”¨å¯¹è±¡ä¸å…¶**éƒ¨åˆ†å‚æ•°**ç»‘å®šï¼Œç”Ÿæˆæ–°çš„å¯è°ƒç”¨å¯¹è±¡ã€‚å¤´æ–‡ä»¶ `<functional>`

> å…¶ä¸»è¦ç”¨é€”æ˜¯**æ ¹æ®éœ€è¦åªç»‘å®šéƒ¨åˆ†å‚æ•°** ï¼Œ**å»¶è¿Ÿæ‰§è¡Œ**ã€‚å¸¸ç”¨äºå›è°ƒå’Œå¼‚æ­¥ä¸­ã€‚



### åŸºæœ¬è¯­æ³•

```cpp
std::bind(Callable&& f, Arg1&& arg1, Arg2&& arg2, ..., ArgN&& argN)
```

- **`Callable`**ï¼š**è¦ç»‘å®šçš„å¯è°ƒç”¨å¯¹è±¡**ï¼ˆå¯ä»¥æ˜¯å‡½æ•°ã€Lambdaã€ä»¿å‡½æ•°ç­‰ï¼‰ã€‚
- **`Arg1, Arg2, ..., ArgN`**ï¼šè¦ç»‘å®šçš„å‚æ•°ã€‚ç»‘å®šçš„å‚æ•°å¯ä»¥æ˜¯å‡½æ•°çš„æŸäº›å›ºå®šå‚æ•°ï¼Œæˆ–è€…ä½¿ç”¨**å ä½ç¬¦** `_1`, `_2` ç­‰è¡¨ç¤ºçš„æœªæ¥å‚æ•°ã€‚

> `std::bind` ä¼šè¿”å›ä¸€ä¸ªæ–°çš„å¯è°ƒç”¨å¯¹è±¡ï¼Œå¯ä»¥ä¼ å…¥å‰©ä½™çš„æœªç»‘å®šå‚æ•°ã€‚



â€‹	**ç¤ºä¾‹ï¼š**

```cpp
#include <iostream>
#include <functional>   // std::bind, std::function, std::placeholders

// ä»¿å‡½æ•°ç±»ï¼ˆå‡½æ•°å¯¹è±¡ï¼‰
struct Operation 
{
    int operator()(int a, int b, int c) const 
    {
        std::cout << "Operation called: ";
        std::cout << a << " + " << b << " + " << c << " = ";
        return a + b + c;
    }
};

int main() 
{
    Operation op;  // åˆ›å»ºä»¿å‡½æ•°å¯¹è±¡

    // ç»‘å®šä»¿å‡½æ•°çš„ä¸‰ä¸ªå‚æ•°ä¸­çš„ä¸€éƒ¨åˆ†
    // ä¾‹å¦‚ï¼šå›ºå®šç¬¬ä¸€ä¸ªå‚æ•°ä¸º10ï¼Œç¬¬äºŒä¸ªå‚æ•°ç”±è°ƒç”¨è€…æä¾›ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°å›ºå®šä¸º30
    auto func = std::bind(op, 10, std::placeholders::_1, 30); //ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¯è°ƒç”¨å¯¹è±¡ï¼ï¼Œæ‰€æœ‰æ˜¯op

    // è°ƒç”¨æ—¶åªéœ€æä¾›ä¸€ä¸ªå‚æ•°ï¼ˆå¯¹åº” _1ï¼‰
    int result = func(20);  // ç­‰ä»·äº op(10, 20, 30)

    std::cout << result << std::endl;

    return 0;
}
```



### å ä½ç¬¦

```cpp
int add(int a,int b,int c){}

auto new_add = std::bind(add, std::placeholders::_3, std::placeholders::_2, std::placeholders::_1);

new_add(1, 2, 3); //å®é™…æ˜¯è°ƒç”¨ 3, 2, 1
```

> `std::placeholders::_1`ã€`std::placeholders::_2` ......



### ä¸lambdaå¯¹æ¯”

> `std::bind` æ›¾åœ¨C++11ä¸­å¹¿æ³›ä½¿ç”¨ï¼Œä½†éšç€Lambdaè¡¨è¾¾å¼çš„æ™®åŠï¼Œå¾ˆå¤šæƒ…å†µä¸‹Lambdaæ›´ä¸ºç›´è§‚å’Œé«˜æ•ˆã€‚ä¸è¿‡ï¼Œåœ¨æŸäº›å¤æ‚çš„å‚æ•°ç»‘å®šåœºæ™¯ä¸‹ï¼Œ`std::bind` ä¾ç„¶æœ‰å…¶ç‹¬ç‰¹ä¼˜åŠ¿ã€‚

| ç‰¹æ€§       | `std::bind`                  | `Lambda`                           |
| ---------- | ---------------------------- | ---------------------------------- |
| **è¯­æ³•**   | ç›¸å¯¹å¤æ‚ï¼Œéœ€è¦ä½¿ç”¨å ä½ç¬¦     | ç®€æ´ï¼Œèƒ½å¤Ÿç›´æ¥æ•è·å˜é‡             |
| **æ€§èƒ½**   | å¯èƒ½æœ‰é¢å¤–çš„å¼€é”€             | é€šå¸¸æ›´é«˜æ•ˆï¼Œç‰¹åˆ«æ˜¯å¯¹å±€éƒ¨å˜é‡æ•è·   |
| **çµæ´»æ€§** | æ”¯æŒéƒ¨åˆ†åº”ç”¨ã€æˆå‘˜å‡½æ•°ç»‘å®šç­‰ | æ›´çµæ´»ï¼Œæ”¯æŒæ•è·ä»»æ„å˜é‡ã€ç®€æ´å®šä¹‰ |
| **å¯è¯»æ€§** | å¯èƒ½å¯¼è‡´ä»£ç ä¸å¤Ÿç›´è§‚         | æ›´ç®€æ´æ˜“è¯»ï¼Œè¯­æ³•æ›´ç›´è§‚             |



â€‹	**`std::bind` ç¤ºä¾‹**

```cpp
#include <iostream>
#include <functional>

int multiply(int a, int b) {
    return a * b;
}

int main() {
    // ç»‘å®šç¬¬ä¸€ä¸ªå‚æ•°ä¸º2ï¼Œç”Ÿæˆæ–°çš„å‡½æ•°å¯¹è±¡
    auto multiplyBy2 = std::bind(multiply, 2, std::placeholders::_1);

    std::cout << "2 * 5 = " << multiplyBy2(5) << std::endl; // è¾“å‡º: 2 * 5 = 10

    return 0;
}
```



â€‹	**`lambda` ç¤ºä¾‹ï¼š**

```cpp
#include <iostream>
#include <functional>

int multiply(int a, int b) {
    return a * b;
}

int main() {
    // ä½¿ç”¨Lambdaè¡¨è¾¾å¼ç»‘å®šç¬¬ä¸€ä¸ªå‚æ•°ä¸º2
    auto multiplyBy2 = [](int b) -> int {
        return multiply(2, b);
    };

    std::cout << "2 * 5 = " << multiplyBy2(5) << std::endl; // è¾“å‡º: 2 * 5 = 10

    return 0;
}
```





## ç»‘å®šç±»çš„æˆå‘˜å‡½æ•°

> åœ¨C++ä¸­ï¼Œæˆå‘˜å‡½æ•°ä¸æ™®é€šå‡½æ•°ä¸åŒï¼Œå› ä¸ºå®ƒä»¬éœ€è¦ä¸€ä¸ªå¯¹è±¡å®ä¾‹æ¥è°ƒç”¨ã€‚ä½¿ç”¨ `std::bind` æˆ– `Lambda` è¡¨è¾¾å¼ï¼Œå¯ä»¥æ–¹ä¾¿åœ°ç»‘å®šç±»çš„æˆå‘˜å‡½æ•°ï¼Œç”Ÿæˆå¯è°ƒç”¨å¯¹è±¡ã€‚



### lambdaç»‘å®šæˆå‘˜å‡½æ•°

â€‹	**ç±»å¤–æ•è·ç¤ºä¾‹ï¼š**

```cpp
#include <iostream>
#include <functional>
class Greeter
{
public:
  void greet(const std::string &name) const
  {
    std::cout << "Hello, " << name << "!" << std::endl;
  }
};

int main()
{
  Greeter greeter;
  // ä½¿ç”¨Lambdaè¡¨è¾¾å¼ç»‘å®šæˆå‘˜å‡½æ•°
  // æ•è·å¤–éƒ¨çš„å®ä¾‹åŒ–å¯¹è±¡
  auto greetFunc = [&greeter](const std::string &name)
  {
    greeter.greet(name);
  };
  greetFunc("Alice"); // è¾“å‡º: Hello, Alice!
  return 0;
}
```



â€‹	**ç±»å†…æ•è·ç¤ºä¾‹:**

â€‹	[å³æ•è·this](#æ•è·this)



### std::bindç»‘å®šæˆå‘˜å‡½æ•°

â€‹	**åŸºæœ¬è¯­æ³•ï¼š**

```cpp
std::bind(&ClassName::memberFunc, object_or_pointer, args...);
```

- `&ClassName::memberFunc`ï¼šæˆå‘˜å‡½æ•°æŒ‡é’ˆ**ï¼ˆæ³¨æ„ä¸€å®šåŠ å–åœ°å€ç¬¦ `&`ï¼‰**

- `object_or_pointer`ï¼šè°ƒç”¨è¯¥æˆå‘˜å‡½æ•°çš„å¯¹è±¡æˆ–å¯¹è±¡æŒ‡é’ˆ **ï¼ˆæ¨èåŠ  `&` é¿å…æ‹·è´ï¼‰**

- `args...`ï¼šç»‘å®šæ—¶ç»™çš„å‚æ•°ï¼ˆå¯ä»¥ç”¨ `_1, _2, ...` å ä½ç¬¦ï¼‰



â€‹	**ç¤ºä¾‹ï¼š**

```cpp
#include <iostream>
#include <functional>

class Calculator
{
public:
  int multiply(int a, int b)
  {
    return a * b;
  }
};

int main()
{
  // ä½¿ç”¨bindç»‘å®šç±»çš„æˆå‘˜å‡½æ•°ï¼Œä½¿å…¶å˜æˆäº†ä¸€ä¸ªæ–°çš„æ™®é€šå‡½æ•°
  Calculator calculator; // ç»‘å®šå‰å…ˆå®ä¾‹åŒ–è¿™ä¸ªå¯¹è±¡

  /** 1. bindé‡Œé¢ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å–ç±»æˆå‘˜å‡½æ•°çš„åœ°å€ï¼Œæ™®é€šå‡½æ•°åå³å‡½æ•°åœ°å€ï¼Œè€Œç±»æˆå‘˜å‡½æ•°éœ€è¦æ‰‹åŠ¨å–åœ°å€
   *  2.ç¬¬äºŒä¸ªå‚æ•°æ˜¯è¯¥æˆå‘˜å‡½æ•°çš„å®ä¾‹åŒ–å¯¹è±¡çš„åœ°å€ï¼Œå› ä¸ºè¦å°†æˆå‘˜å‡½æ•°ç»‘å®šåˆ°å®ä¾‹åŒ–å¯¹è±¡ä¸Šæ‰èƒ½è°ƒç”¨ã€‚
   *  3. ç¬¬ä¸‰ç¬¬å››å°±æ˜¯æˆå‘˜å‡½æ•°çš„å‚æ•°äº†ï¼Œç¬¬ä¸€ä¸ªé»˜è®¤ï¼Œç¬¬äºŒä¸ªå ä½
   * **/
  auto new_multiply = std::bind(&Calculator::multiply, &calculator, 5, std::placeholders::_1);
  std::cout << "5 * 3 = " << new_multiply(3) << std::endl;
}
```

| å†™æ³•          | ç±»å‹          | æ˜¯å¦å¤åˆ¶å¯¹è±¡ | è°ƒç”¨å“ªä¸€ä¸ªå¯¹è±¡ |
| ------------- | ------------- | ------------ | -------------- |
| `&calculator` | `Calculator*` | âŒ ä¸å¤åˆ¶     | åŸå¯¹è±¡         |
| `calculator`  | `Calculator`  | âœ… ä¼šå¤åˆ¶     | å‰¯æœ¬           |





### ç»‘å®šé™æ€æˆå‘˜å‡½æ•°

> é™æ€æˆå‘˜å‡½æ•°ä¸ä¾èµ–äºç±»çš„å®ä¾‹ï¼Œå°±ä¸ç”¨ç»‘å®šå®ä¾‹åŒ–å¯¹è±¡äº†ã€‚å¯ä»¥åƒæ™®é€šå‡½æ•°ä¸€æ ·ä½¿ç”¨ `std::bind` å’Œ `std::function`ã€‚

â€‹	**ç¤ºä¾‹ï¼š**

```cpp
#include <iostream>
#include <functional>

class Logger 
{
public:
    static void log(const std::string& message)
    {
        std::cout << "Log: " << message << std::endl;
    }
};

int main()
{
    // ä½¿ç”¨std::bindç»‘å®šé™æ€æˆå‘˜å‡½æ•°
    auto logFunc = std::bind(&Logger::log, std::placeholders::_1); //ä¸ç”¨ç»‘å®šå¯¹è±¡

    logFunc("This is a static log message."); // è¾“å‡º: Log: This is a static log message.

    return 0;
}
```



## ç»¼åˆæ¡ˆä¾‹

```cpp
#include <iostream>
#include <functional>
#include <vector>
#include <algorithm>

// 1. æ™®é€šå‡½æ•°
int add(int a, int b) {
    return a + b;
}

// 2. ä»¿å‡½æ•°ï¼ˆFunctorsï¼‰
struct Multiply {
    int operator()(int a, int b) const {
        return a * b;
    }
};

// 3. Lambdaè¡¨è¾¾å¼
auto subtract = [](int a, int b) -> int {
    return a - b;
};

// 4. ç±»å®šä¹‰
class Calculator {
public:
    int subtract(int a, int b) const {
        return a - b;
    }

    void displayOperation(const std::string& op, int result) const {
        std::cout << op << "ç»“æœ: " << result << std::endl;
    }
};

// 5. é™æ€æˆå‘˜å‡½æ•°
class Logger {
public:
    static void log(const std::string& message) {
        std::cout << "Log: " << message << std::endl;
    }
};

int main() {
    // 1. å‡½æ•°æŒ‡é’ˆ
    int (*funcPtr)(int, int) = &add;
    std::cout << "Add (Function Pointer): " << funcPtr(10, 5) << std::endl; // è¾“å‡º: 15

    // 2. ä»¿å‡½æ•°ï¼ˆFunctorsï¼‰
    Multiply multiply;
    std::cout << "Multiply (Functors): " << multiply(10, 5) << std::endl; // è¾“å‡º: 50

    // 3. Lambdaè¡¨è¾¾å¼
    std::cout << "Subtract (Lambda): " << subtract(10, 5) << std::endl; // è¾“å‡º: 5

    // 4. std::function å°è£…ä¸åŒå¯è°ƒç”¨å¯¹è±¡
    std::function<int(int, int)> funcAdd = add;
    std::function<int(int, int)> funcSubtract = subtract;
    std::function<int(int, int)> funcMultiply = multiply;

    std::cout << "Add (std::function): " << funcAdd(20, 10) << std::endl; // è¾“å‡º: 30
    std::cout << "Subtract (std::function): " << funcSubtract(20, 4) << std::endl; // è¾“å‡º: 16
    std::cout << "Multiply (std::function): " << funcMultiply(4, 5) << std::endl; // è¾“å‡º: 20

    // 5. std::bind ç»‘å®šéƒ¨åˆ†å‚æ•°
    auto add5 = std::bind(add, 5, std::placeholders::_1);
    std::cout << "5 + 10 = " << add5(10) << std::endl; // è¾“å‡º: 15

    auto multiplyBy2 = std::bind(multiply, 2, std::placeholders::_1);
    std::cout << "2 * 10 = " << multiplyBy2(10) << std::endl; // è¾“å‡º: 20

    // 6. ç»‘å®šç±»æˆå‘˜å‡½æ•°
    Calculator calc;

    // ä½¿ç”¨ std::bind ç»‘å®šæˆå‘˜å‡½æ•° subtract
    auto boundSubtract = std::bind(&Calculator::subtract, &calc, 15, 5);
    std::cout << "15 - 5 = " << boundSubtract() << std::endl; // è¾“å‡º: 10

    // ä½¿ç”¨ std::bind ç»‘å®šæˆå‘˜å‡½æ•° displayOperation
    auto displayAdd = std::bind(&Calculator::displayOperation, &calc, "Add", std::placeholders::_1);
    auto displayResult = funcAdd;
    int addResult = displayResult(7, 8); // 15
    displayAdd(addResult); // è¾“å‡º: Addç»“æœ: 15

    // 7. ç»‘å®šé™æ€æˆå‘˜å‡½æ•°
    auto logFunc = std::bind(&Logger::log, std::placeholders::_1);
    logFunc("This is a static log message."); // è¾“å‡º: Log: This is a static log message.

    // 8. ä½¿ç”¨ std::function å­˜å‚¨æ··åˆå¯è°ƒç”¨å¯¹è±¡
    std::vector<std::function<void()>> operations;

    // æ·»åŠ ä¸åŒçš„æ“ä½œåˆ°å®¹å™¨
    operations.emplace_back([&]() { std::cout << "Lambda Operation" << std::endl; });
    operations.emplace_back(std::bind(&Calculator::displayOperation, &calc, "Multiply", 30));
    operations.emplace_back([&]() { std::cout << "Add5(10): " << add5(10) << std::endl; });
    operations.emplace_back([&]() { Logger::log("Lambda-based log message."); });

    // æ‰§è¡Œæ‰€æœ‰æ“ä½œ
    for(auto& op : operations) {
        op();
    }
    /*
    è¾“å‡º:
    Lambda Operation
    Multiplyç»“æœ: 30
    Add5(10): 15
    Log: Lambda-based log message.
    */

    return 0;
}
```



1. **å‡½æ•°æŒ‡é’ˆ:** å®šä¹‰å¹¶ä½¿ç”¨äº†æŒ‡å‘ `add` å‡½æ•°çš„å‡½æ•°æŒ‡é’ˆ `funcPtr`ã€‚

2. **ä»¿å‡½æ•°ï¼ˆFunctorsï¼‰:** å®šä¹‰äº† `Multiply` ç»“æ„ä½“ï¼Œå¹¶ä½¿ç”¨å…¶å®ä¾‹ `multiply` è¿›è¡Œä¹˜æ³•è¿ç®—ã€‚

3. **Lambdaè¡¨è¾¾å¼:** å®šä¹‰äº†ä¸€ä¸ªç”¨äºå‡æ³•çš„Lambda `subtract`ã€‚

5. `std::function`**:** å°è£…äº†ä¸åŒç±»å‹çš„å¯è°ƒç”¨å¯¹è±¡ï¼ŒåŒ…æ‹¬æ™®é€šå‡½æ•°ã€Lambdaå’Œä»¿å‡½æ•°ã€‚

6. `std::bind`**:** ç»‘å®š `add` å’Œ `multiply` å‡½æ•°çš„éƒ¨åˆ†å‚æ•°ï¼Œç”Ÿæˆæ–°çš„å¯è°ƒç”¨å¯¹è±¡ `add5` å’Œ `multiplyBy2`ã€‚

7. **ç»‘å®šç±»æˆå‘˜å‡½æ•°:** ä½¿ç”¨ `std::bind` ç»‘å®š `Calculator` ç±»çš„æˆå‘˜å‡½æ•° `subtract` å’Œ `displayOperation`ã€‚

8. **ç»‘å®šé™æ€æˆå‘˜å‡½æ•°:** ä½¿ç”¨ `std::bind` ç»‘å®š `Logger` ç±»çš„é™æ€æˆå‘˜å‡½æ•° `log`ã€‚

9. **æ··åˆå¯è°ƒç”¨å¯¹è±¡å®¹å™¨:** ä½¿ç”¨ `std::function` å’Œ `std::vector` å­˜å‚¨å¹¶æ‰§è¡Œä¸åŒç±»å‹çš„å¯è°ƒç”¨å¯¹è±¡ï¼ŒåŒ…æ‹¬Lambdaã€ç»‘å®šæˆå‘˜å‡½æ•°å’Œé™æ€æˆå‘˜å‡½æ•°ã€‚
